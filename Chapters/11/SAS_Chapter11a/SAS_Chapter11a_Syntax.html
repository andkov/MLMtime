<!DOCTYPE html><html><head><title>C:\Dropbox\PilesOfVariance\Chapter11a\SAS\SAS_Chapter11a_Syntax.sas formatted</title><style type="text/css">
body, pre { font-family: "Courier New", Courier, monospace; }
.comment { color: #008000; font-weight: 700; }
.string { color: #800080; font-weight: 700; }
.number { color: #008080; font-weight: 700; }
.macro { color: #008080; font-weight: 700; }
.command { color: #000080; font-weight: 700; }
.keywords { color: #0000ff; font-weight: 700; }
.data-line { background-color: #ffffcc; font-weight: 400; }
</style>
</head><body><pre>
<html><head></head><body><span class="comment">* Output options: all can be turned on/off by adding or removing the NO;</span>
<span class="comment">* page number, date, centering, or page breaks, page length and width;</span>
<span class="keywords">OPTIONS</span> NOnumber NOdate NOcenter FormDlim=<span class="string">' '</span> PageSize=<span class="keywords">MAX</span> LineSize=<span class="keywords">MAX</span>;
<span class="comment">* Eliminate SAS default titles and names of tables in output (TRACE ON to show);</span>
<span class="keywords">TITLE</span>; <span class="keywords">ODS</span> <span class="keywords">TRACE</span> <span class="keywords">OFF</span>; <span class="keywords">ODS</span> <span class="keywords">LISTING</span> <span class="keywords">CLOSE</span>;

<span class="comment">***********************************************************************************;</span>
<span class="comment">*******   MACRO PROGRAMS TO AUTOMATE CALCULATIONS FOR CHAPTER 11a EXAMPLE   *******;</span>
<span class="comment">*******               NOTHING IN HERE NEEDS TO BE CHANGED                   *******;</span>
<span class="comment">***********************************************************************************;</span>

<span class="comment">* To use FitTest macro;</span>
<span class="comment">* FitFewer = name of infocrit table for nested model;</span>
<span class="comment">* FitMore  = name of infocrit table for comparison model;</span>
<span class="command"><span class="keywords">%MACRO</span></span> FitTest(FitFewer=,FitMore=);
<span class="command">DATA</span> <span class="macro">&amp;FitFewer.</span>; <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> <span class="macro">&amp;FitFewer.</span>; Name=<span class="string">&quot;<span class="string">&amp;FitFewer.</span>&quot;</span>; <span class="command">RUN</span>;
<span class="command">DATA</span> <span class="macro">&amp;FitMore.</span>;  <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> <span class="macro">&amp;FitMore.</span>;  Name=<span class="string">&quot;<span class="string">&amp;FitMore.</span>&quot;</span>;  <span class="command">RUN</span>;
<span class="command">DATA</span> FitCompare; <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> <span class="macro">&amp;FitFewer.</span> <span class="macro">&amp;FitMore.</span>; <span class="command">RUN</span>;
<span class="command">DATA</span> FitCompare; <span class="keywords">SET</span> FitCompare; DevDiff=Lag1(Neg2LogLike)-Neg2LogLike;
     DFdiff=Parms-LAG1(Parms); Pvalue=<span class="number">1</span>-PROBCHI(DevDiff,DFdiff);
     <span class="keywords">DROP </span>AICC HQIC CAIC; <span class="command">RUN</span>;
<span class="keywords"><span class="keywords">TITLE</span>9</span> <span class="string">&quot;Likelihood Ratio Test for <span class="string">&amp;FitFewer.</span> vs. <span class="string">&amp;FitMore.</span>&quot;</span>;
<span class="command">PROC PRINT</span> <span class="keywords">NOOBS</span> <span class="command">DATA</span>=FitCompare; <span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>9</span>;
<span class="command"><span class="keywords">%M<span class="keywords">END</span></span></span> FitTest;

<span class="comment">* To use TotalR2 macro;</span>
<span class="comment">* DV =        case-sensitive name of dependent variable;</span>
<span class="comment">* PredFewer = name of dataset of predicted outcomes for nested model;</span>
<span class="comment">* PredMore =  name of dataset of predicted outcomes for comparison model;</span>
<span class="command"><span class="keywords">%MACRO</span></span> TotalR2(DV=,PredFewer=,PredMore=);
<span class="command">PROC CORR</span> <span class="keywords">NOPRINT</span> NOSIMPLE <span class="command">DATA</span>=<span class="macro">&amp;PredFewer.</span> <span class="keywords">OUTP</span>=CorrFewer; <span class="keywords">VAR</span> pred <span class="macro">&amp;DV.</span>; <span class="command">RUN</span>;
<span class="command">PROC CORR</span> <span class="keywords">NOPRINT</span> NOSIMPLE <span class="command">DATA</span>=<span class="macro">&amp;PredMore.</span>  <span class="keywords">OUTP</span>=CorrMore;  <span class="keywords">VAR</span> pred <span class="macro">&amp;DV.</span>; <span class="command">RUN</span>;
<span class="command">DATA</span> CorrFewer; <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> CorrFewer; Name=<span class="string">&quot;<span class="string">&amp;PredFewer.</span>&quot;</span>; <span class="command">RUN</span>;
<span class="command">DATA</span> CorrMore;  <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> CorrMore;  Name=<span class="string">&quot;<span class="string">&amp;PredMore.</span>&quot;</span>;  <span class="command">RUN</span>;
<span class="command">DATA</span> CorrCompare; <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> CorrFewer CorrMore; 
     PredCorr=Pred; TotalR2=PredCorr*PredCorr; 
     <span class="keywords">IF</span> _NAME_=<span class="string">&quot;Pred&quot;</span> OR MISSING(_NAME_)=<span class="number">1</span> <span class="keywords">THEN</span> <span class="keywords">DELETE</span>; <span class="keywords">DROP </span>Pred; <span class="command">RUN</span>;
<span class="command">DATA</span> CorrCompare; <span class="keywords">SET</span> CorrCompare; TotalR2Diff=TotalR2-LAG1(TotalR2);
     <span class="keywords">KEEP</span> Name PredCorr TotalR2 TotalR2Diff; <span class="command">RUN</span>; 
<span class="keywords"><span class="keywords">TITLE</span>9</span> <span class="string">&quot;Total R2 (% Reduction) for <span class="string">&amp;PredFewer.</span> vs. <span class="string">&amp;PredMore.</span>&quot;</span>;
<span class="command">PROC PRINT</span> <span class="keywords">NOOBS</span> <span class="command">DATA</span>=CorrCompare; <span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>9</span>; 
<span class="command"><span class="keywords">%M<span class="keywords">END</span></span></span> TotalR2;

<span class="comment">* To use PseudoR2 macro;</span>
<span class="comment">* Ncov =     TOTAL # entries in covariance parameters output table;</span>
<span class="comment">* CovFewer = name of covparms table for nested model;</span>
<span class="comment">* CovMore =  name of covparms table for comparison modell;</span>
<span class="command"><span class="keywords">%MACRO</span></span> PseudoR2(NCov=,CovFewer=,CovMore=);
<span class="command">DATA</span> <span class="macro">&amp;CovFewer.</span>; <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> <span class="macro">&amp;CovFewer.</span>; Name=<span class="string">&quot;<span class="string">&amp;CovFewer.</span>&quot;</span>; <span class="command">RUN</span>;
<span class="command">DATA</span> <span class="macro">&amp;CovMore.</span>;  <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> <span class="macro">&amp;CovMore.</span>;  Name=<span class="string">&quot;<span class="string">&amp;CovMore.</span>&quot;</span>;  <span class="command">RUN</span>;
<span class="command">DATA</span> CovCompare; <span class="keywords">LENGTH</span> Name $<span class="number">30</span>.; <span class="keywords">SET</span> <span class="macro">&amp;CovFewer.</span> <span class="macro">&amp;CovMore.</span>; <span class="command">RUN</span>;
<span class="command">DATA</span> CovCompare; <span class="keywords">SET</span> CovCompare; 
     PseudoR2=(LAG<span class="macro">&amp;Ncov.</span>(Estimate)-Estimate)/LAG<span class="macro">&amp;Ncov.</span>(Estimate); <span class="command">RUN</span>;
<span class="command">DATA</span> CovCompare; <span class="keywords">SET</span> CovCompare; 
     <span class="keywords">IF</span> CovParm IN(<span class="string">&quot;UN(2,1)&quot;</span>,<span class="string">&quot;UN(3,1)&quot;</span>,<span class="string">&quot;UN(4,1)&quot;</span>,<span class="string">&quot;UN(3,2)&quot;</span>,<span class="string">&quot;UN(4,2)&quot;</span>,<span class="string">&quot;UN(4,3)&quot;</span>) 
     <span class="keywords">THEN</span> <span class="keywords">DELETE</span>; <span class="command">RUN</span>;
<span class="keywords"><span class="keywords">TITLE</span>9</span> <span class="string">&quot;PsuedoR2 (% Reduction) for <span class="string">&amp;CovFewer.</span> vs. <span class="string">&amp;CovMore.</span>&quot;</span>;
<span class="command">PROC PRINT</span> <span class="keywords">NOOBS</span> <span class="command">DATA</span>=CovCompare; <span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>9</span>;
<span class="command"><span class="keywords">%M<span class="keywords">END</span></span></span> PseudoR2;

<span class="comment">***********************************************************************************;</span>
<span class="comment">*******    BEGIN DATA MANIPULATION FOR CHAPTER 11a THREE-LEVEL EXAMPLE      *******;</span>
<span class="comment">*******                 CHANGE &quot;filesave&quot; to your directory                 *******;</span>
<span class="comment">***********************************************************************************;</span>

<span class="comment">* Defining global variable for file location to be replaced in code below;</span>
<span class="keywords">%LET</span> filesave= C:\Dropbox\PilesOfVariance\Chapter11a\SAS;
<span class="comment">* Location for SAS files for these models (uses macro variable filesave);</span>
<span class="keywords">LIBNAME</span> filesave <span class="string">&quot;<span class="string">&amp;filesave.</span>&quot;</span>;

<span class="comment">* Import chapter 11a multivariate data in work library;</span>
<span class="comment">* Also make student mean variables;</span>
<span class="command">DATA</span> work.Chapter11amultiv; <span class="keywords">SET</span> filesave.SAS_Chapter11a;
SMclose  = <span class="keywords">MEAN</span>(OF  close_wave1  close_wave2  close_wave3);
SMvictim = <span class="keywords">MEAN</span>(OF victim_wave1 victim_wave2 victim_wave3);
<span class="keywords">LABEL</span> 
SMclose =  <span class="string">&quot;SMclose: Student Mean Closeness&quot;</span>
SMvictim = <span class="string">&quot;SMvictim: Student Mean Victimization&quot;</span>;
<span class="command">RUN</span>;

<span class="comment">* Get class means for student and per-wave variables (keeping level-3 variables);</span>
<span class="command">PROC SORT</span> <span class="command">DATA</span>=work.Chapter11amultiv;<span class="keywords"> BY</span> ClassID StudentID; <span class="command">RUN</span>;
<span class="command">PROC <span class="keywords">MEAN</span>S</span> <span class="keywords">NOPRINT</span> <span class="command">DATA</span>=work.Chapter11amultiv;<span class="keywords"> BY</span> ClassID classsize grade;
     <span class="keywords">VAR</span> SMclose SMvictim girl emosup_wave1 emosup_wave2 emosup_wave3;
     <span class="keywords"><span class="keywords">OUTP</span>UT</span> OUT=work.ClassMeans11a
     <span class="keywords">MEAN</span>(SMclose SMvictim girl emosup_wave1 emosup_wave2 emosup_wave3) 
        = CMclose CMvictim CMgirl CMemosup_wave1 CMemosup_wave2 CMemosup_wave3;
<span class="command">RUN</span>;

<span class="comment">* Make class mean emosup and add labels;</span>
<span class="command">DATA</span> work.ClassMeans11a; <span class="keywords">SET</span> work.ClassMeans11a;
CMemosup = <span class="keywords">MEAN</span>(OF CMemosup_wave1 CMemosup_wave2 CMemosup_wave3);
<span class="keywords">LABEL</span>
CMemosup = <span class="string">&quot;CMemosup: Class Mean Emotional Support&quot;</span>
CMclose = <span class="string">&quot;CMclose: Class Mean Student-Teacher Closeness&quot;</span>
CMvictim = <span class="string">&quot;CMvictim3: Class Mean Student-Perceived Victimization&quot;</span>
CMgirl = <span class="string">&quot;CMgirl: Percentage Girls in Class&quot;</span>;
<span class="comment">* Create level-3 variables for analysis;</span>
size23 = classsize - <span class="number">23</span>;
<span class="keywords">IF</span> grade=<span class="number">3</span> <span class="keywords">THEN</span> grade35=<span class="number">0</span>;
<span class="keywords">IF</span> grade=<span class="number">5</span> <span class="keywords">THEN</span> grade35=<span class="number">1</span>;
CMgirl50 = CMgirl - .50;
CMemosup5 = CMemosup - <span class="number">5</span>;
CMvictim3 = CMvictim - <span class="number">3</span>;
<span class="keywords">LABEL</span>
size23 = <span class="string">&quot;size23: # Students in Class (0=<span class="string">23</span>)&quot;</span>
grade35 = <span class="string">&quot;grade35: Grade <span class="string">3</span>=<span class="string">0</span>, Grade5=<span class="string">1</span>&quot;</span>
CMgirl50 = <span class="string">&quot;CMgirl50: Percentage Girls in Class (0=.50)&quot;</span>
CMemosup5 = <span class="string">&quot;CMemosup5: Class Mean Emotional Support (0=<span class="string">5</span>)&quot;</span>
CMvictim3 = <span class="string">&quot;CMvictim3: Class Mean Student-Perceived Victimization (0=<span class="string">3</span>)&quot;</span>;
<span class="command">RUN</span>;

<span class="comment">* Merge class means into multivariate data;</span>
<span class="command">DATA</span> work.Chapter11amultiv; <span class="keywords">MERGE</span> work.Chapter11amultiv work.ClassMeans11a;
BY ClassID classsize grade; 
<span class="keywords">DROP </span>_TYPE_ _FREQ_ emosup_wave1-emosup_wave3;
<span class="comment">* Create level-2 variables for analysis;</span>
WCclose = SMclose - CMclose;
SMvictim3 = SMvictim - <span class="number">3</span>;
WCvictim = SMvictim - CMvictim;
<span class="keywords">LABEL</span>
WCclose = <span class="string">&quot;WCclose: Within-Class Student-Teacher Closeness (0=CM)&quot;</span>
SMvictim3 = <span class="string">&quot;SMvictim3: Student Mean Student-Perceived Victimization (0=<span class="string">3</span>)&quot;</span>
WCvictim = <span class="string">&quot;WCvictim: Within-Class Student-Perceived Victimization (0=CM)&quot;</span>;
<span class="command">RUN</span>;

<span class="comment">* Stack multivariate data by wave;</span>
<span class="command">DATA</span> work.Chapter11a; <span class="keywords">SET</span> work.Chapter11amultiv;
wave=<span class="number">1</span>; emosup=CMemosup_wave1; victim=victim_wave1; close=close_wave1; <span class="keywords"><span class="keywords">OUTP</span>UT</span>;
wave=<span class="number">2</span>; emosup=CMemosup_wave2; victim=victim_wave2; close=close_wave2; <span class="keywords"><span class="keywords">OUTP</span>UT</span>;
wave=<span class="number">3</span>; emosup=CMemosup_wave3; victim=victim_wave3; close=close_wave3; <span class="keywords"><span class="keywords">OUTP</span>UT</span>;
<span class="comment">* Drop old unnecessary multivariate variables;</span>
<span class="keywords">DROP </span>CMemosup_wave1-CMemosup_wave3 victim_wave1-victim_wave3 close_wave1-close_wave3;
<span class="keywords">LABEL</span>
wave = <span class="string">&quot;wave: Wave of Study (1-<span class="string">3</span>)&quot;</span>
emosup = <span class="string">&quot;emosup: Time-Varying Class Emotional Support&quot;</span>
victim = <span class="string">&quot;victim: Time-Varying Student-Perceived Victimization&quot;</span>
close = <span class="string">&quot;close: Time-Varying Student-Teacher Closeness&quot;</span>;
<span class="command">RUN</span>;

<span class="comment">* Sort data by level and create level-1 variables for analysis;</span>
<span class="command">PROC SORT</span> <span class="command">DATA</span>=work.Chapter11a;<span class="keywords"> BY</span> ClassID StudentID wave; <span class="command">RUN</span>;
<span class="command">DATA</span> work.Chapter11a; <span class="keywords">SET</span> work.Chapter11a;
time1 = wave - <span class="number">1</span>;
time2 = wave - <span class="number">2</span>;
<span class="keywords">IF</span> wave&lt;3 <span class="keywords">THEN</span> w3=<span class="number">0</span>; <span class="keywords">ELSE</span> <span class="keywords">IF</span> wave=<span class="number">3</span> <span class="keywords">THEN</span> w3=<span class="number">1</span>;
WSclose = close - SMclose;
victim3 = victim - <span class="number">3</span>;
WSvictim = victim - SMvictim;
emosup5 = emosup - <span class="number">5</span>;
WCemosup = emosup - CMemosup;
<span class="keywords">LABEL</span>
time1 = <span class="string">&quot;time1: Time in Study (0=Wave1)&quot;</span>
time2 = <span class="string">&quot;time2: Time in Study (0=Wave2)&quot;</span>
w3 = <span class="string">&quot;w3: Is Wave3 (0=no, <span class="string">1</span>=yes)&quot;</span>
WSclose = <span class="string">&quot;WSclose: Within-Student Student-Teacher Closeness (0=SM)&quot;</span>
victim3 = <span class="string">&quot;victim3: Time-Varying Student-Perceived Victimization (0=<span class="string">3</span>)&quot;</span>
WSvictim = <span class="string">&quot;WSvictim: Within-Student Student-Perceived Victimization (0=SM)&quot;</span>
emosup5 = <span class="string">&quot;emosup5: Time-Varying Class Emotional Support (0=<span class="string">5</span>)&quot;</span>
WCemosup = <span class="string">&quot;WCemosup: Within-Class Emotional Support (0=CM)&quot;</span>;
<span class="comment">* Subset sample to complete cases for all predictors;</span>
<span class="keywords">IF</span> NMISS(wave, victim, emosup, girl, classsize, close)&gt;0 <span class="keywords">THEN</span> <span class="keywords">DELETE</span>;
<span class="command">RUN</span>;

<span class="comment">* Get class by wave dataset for later;</span>
<span class="command">PROC SORT</span> <span class="command">DATA</span>=work.Chapter11a;<span class="keywords"> BY</span> ClassID wave; <span class="command">RUN</span>;
<span class="command">PROC <span class="keywords">MEAN</span>S</span> <span class="keywords">NOPRINT</span> <span class="command">DATA</span>=work.Chapter11a;<span class="keywords"> BY</span> ClassID wave;
     <span class="keywords">VAR</span> emosup WCemosup; 
     <span class="keywords"><span class="keywords">OUTP</span>UT</span> OUT=work.ClassPerWave11a
     <span class="keywords">MEAN</span>(emosup WCemosup) = emosup WCemosup;
<span class="command">RUN</span>;
<span class="comment">* Add level-1 time;</span>
<span class="command">DATA</span> work.ClassPerWave11a; <span class="keywords">SET</span> work.ClassPerWave11a;
<span class="keywords">DROP </span>_TYPE_ _FREQ_; 
time1 = wave - <span class="number">1</span>;
<span class="keywords">LABEL</span> time1 = <span class="string">&quot;time1: Time in Study (0=Wave1)&quot;</span>;
<span class="command">RUN</span>;

<span class="comment">***********************************************************************************;</span>
<span class="comment">*****       BEGIN CHAPTER 11a TIME-INVARIANT GROUP THREE-LEVEL MODELS         *****;</span>
<span class="comment">***********************************************************************************;</span>

<span class="comment">* Open output directory to save results to;</span>
<span class="keywords">ODS</span> <span class="keywords">HTML </span><span class="keywords">FILE</span>=<span class="string">&quot;<span class="string">&amp;filesave.</span>\SAS_Chapter11a_Output.html&quot;</span>
         (<span class="keywords">URL</span>=<span class="string">&quot;SAS_Chapter11a_Output.html&quot;</span>) <span class="keywords">STYLE</span>=HTMLBlue;

<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">&quot;Chapter <span class="string">11</span>a: Descriptive Statistics for Level-<span class="string">1</span> Time-Varying Student Variables&quot;</span>;
<span class="command">PROC <span class="keywords">MEAN</span>S</span><span class="keywords"> N </span><span class="keywords">MEAN</span> STDDEV <span class="keywords">VAR</span> <span class="keywords">MIN</span> <span class="keywords">MAX</span> <span class="command">DATA</span>=work.Chapter11a; 
     <span class="keywords">VAR</span> close WSclose victim WSvictim; 
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>;

<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">&quot;Chapter <span class="string">11</span>a: Descriptive Statistics for Level-<span class="string">1</span> Time-Varying Class Variables&quot;</span>;
<span class="command">PROC <span class="keywords">MEAN</span>S</span><span class="keywords"> N </span><span class="keywords">MEAN</span> STDDEV <span class="keywords">VAR</span> <span class="keywords">MIN</span> <span class="keywords">MAX</span> <span class="command">DATA</span>=work.ClassPerWave11a; 
     <span class="keywords">VAR</span> emosup WCemosup; 
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>;

<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">&quot;Chapter <span class="string">11</span>a: Descriptive Statistics for Level-<span class="string">2</span> Student Variables&quot;</span>;
<span class="command">PROC <span class="keywords">MEAN</span>S</span><span class="keywords"> N </span><span class="keywords">MEAN</span> STDDEV <span class="keywords">VAR</span> <span class="keywords">MIN</span> <span class="keywords">MAX</span> <span class="command">DATA</span>=work.Chapter11amultiv; 
     <span class="keywords">VAR</span> SMclose WCclose SMvictim WCvictim girl; 
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>;

<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">&quot;Chapter <span class="string">11</span>a: Descriptive Statistics for Level-<span class="string">3</span> Class Variables&quot;</span>;
<span class="command">PROC <span class="keywords">MEAN</span>S</span><span class="keywords"> N </span><span class="keywords">MEAN</span> STDDEV <span class="keywords">VAR</span> <span class="keywords">MIN</span> <span class="keywords">MAX</span> <span class="command">DATA</span>=work.ClassMeans11a; 
     <span class="keywords">VAR</span> CMclose CMvictim CMemosup CMgirl classsize grade35; 
<span class="command">RUN</span>; 

<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Empty Means, Two-Level Model Predicting Student-Teacher Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Occasions Within Students*Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close =  / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitEmpty2C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.1: Empty Means, Three-Level Model Predicting Student-Teacher Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Level-<span class="string">1</span> Occasions Within Level-<span class="string">2</span> Students Within Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close =  / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite <span class="keywords"><span class="keywords">OUTP</span>M</span>=PredEmpty3C;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitEmpty3C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitEmpty2C, FitMore=FitEmpty3C);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Empty Means, Two-Level Model Predicting Student-Perceived Victimization'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Occasions Within Students*Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> victim =  / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitEmpty2V;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.1: Empty Means, Three-Level Model Predicting Student-Perceived Victimization'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Level-<span class="string">1</span> Occasions Within Level-<span class="string">2</span> Students Within Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> victim =  / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite <span class="keywords"><span class="keywords">OUTP</span>M</span>=PredEmpty3V;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitEmpty3V;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitEmpty2V, FitMore=FitEmpty3V);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.1: Empty Means, Levels <span class="string">1</span> and <span class="string">3</span> Model Predicting Class Emotional Support'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Level-<span class="string">1</span> Ocasions Within Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> emosup =  / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite <span class="keywords"><span class="keywords">OUTP</span>M</span>=PredEmpty3E;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitEmpty3E;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.1: Empty Means, Levels <span class="string">1</span> and <span class="string">3</span> Model Predicting Class Emotional Support'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Level-<span class="string">1</span> Ocasions Within Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.ClassPerWave11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID;
     <span class="keywords">MODEL</span> emosup =  / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.3: Saturated Means, Unstructured Level-<span class="string">3</span> and Level-<span class="string">2</span> Variances'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID wave;
     <span class="keywords">MODEL</span> close = wave / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> wave /<span class="keywords"> G </span><span class="keywords">GCORR</span><span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords">REPEATED</span> wave /<span class="keywords"> R </span><span class="keywords">RCORR</span><span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitSatUNC;
     <span class="keywords">LS<span class="keywords">MEAN</span>S</span> wave / <span class="keywords">D<span class="keywords">IF</span>F</span><span class="keywords">=ALL</span><span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Piecewise Means, Level-<span class="string">3</span> and Level-<span class="string">2</span> Random Intercepts'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Three-Level Model Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 w3 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitPieceRI2RI3C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Piecewise Means, Add Level-<span class="string">2</span> Random Time Slope'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Three-Level Model Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 w3 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitPieceRL2RI3C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitPieceRI2RI3C, FitMore=FitPieceRL2RI3C);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Piecewise Means, Add Level-<span class="string">3</span> Random Time Slope'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Three-Level Model Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 w3 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitPieceRL2RL3C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitPieceRL2RI3C, FitMore=FitPieceRL2RL3C);
     %FitTest(FitFewer=FitPieceRL2RL3C, FitMore=FitSatUNC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.4: Unconditional Growth Model Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Random Linear Time Slopes for Level-<span class="string">2</span> Students and Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite <span class="keywords"><span class="keywords">OUTP</span>M</span>=PredUncC;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovUncC;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate Total R2 for overall model;</span>
     %TotalR2(DV=close, PredFewer=PredEmpty3C, PredMore=PredUncC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Class Grade and Class Size'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 grade35 time1*grade35 size23 time1*size23 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Class Size Only'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 size23 time1*size23 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovSizeC;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">7</span>, CovFewer=CovUncC, CovMore=CovSizeC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.5: Add Student and Class Gender'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 size23 time1*size23
                   girl time1*girl CMgirl50 time1*CMgirl50
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovGirlC InfoCrit=FitGirlC;
     <span class="keywords">CONTRAST</span> <span class="string">'Multivariate Test of Level-<span class="string">2</span> Within-Class Gender Effects'</span> girl <span class="number">1</span>, time1*girl <span class="number">1</span> / <span class="keywords">CHISQ</span>;
     <span class="keywords">CONTRAST</span> <span class="string">'Multivariate Test of Level-<span class="string">3</span> Contextual Class Gender Effects'</span> CMgirl50 <span class="number">1</span>, time1*CMgirl50 <span class="number">1</span> / <span class="keywords">CHISQ</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Contextual Gender Effect at Wave <span class="string">1</span>'</span>         CMgirl50 <span class="number">1</span> CMgirl50*time1 <span class="number">0</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Contextual Gender Effect at Wave <span class="string">2</span>'</span>         CMgirl50 <span class="number">1</span> CMgirl50*time1 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Contextual Gender Effect at Wave <span class="string">3</span>'</span>         CMgirl50 <span class="number">1</span> CMgirl50*time1 <span class="number">2</span> /<span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">7</span>, CovFewer=CovSizeC, CovMore=CovGirlC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Test if Level-<span class="string">3</span> Random Time Slope Variance is still needed'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 size23 time1*size23
                   girl time1*girl CMgirl50 time1*CMgirl50
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=NoRandTime3C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=NoRandTime3C, FitMore=FitGirlC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Random Gender Effect across Classes'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 size23 time1*size23
                   girl time1*girl CMgirl50 time1*CMgirl50
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 girl /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitRandGirlC;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitGirlC, FitMore=FitRandGirlC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Saturated Means, Unstructured Model Predicting Class Emotional Support'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Only Level-<span class="string">1</span> Ocasions Within Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.ClassPerWave11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID wave;
     <span class="keywords">MODEL</span> emosup = wave / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords">REPEATED</span> wave /<span class="keywords"> R </span><span class="keywords">RCORR</span><span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitSatUNE;
     <span class="keywords">LS<span class="keywords">MEAN</span>S</span> wave / <span class="keywords">D<span class="keywords">IF</span>F</span><span class="keywords">=ALL</span><span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Saturated Means, Random Intercept Model Predicting Class Emotional Support'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Only Level-<span class="string">1</span> Ocasions Within Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.ClassPerWave11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID wave;
     <span class="keywords">MODEL</span> emosup = wave / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitSatRIE;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitSatRIE, FitMore=FitSatUNE);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Saturated Means, Random Time Slope Model Predicting Class Emotional Support'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Only Level-<span class="string">1</span> Ocasions Within Level-<span class="string">3</span> Classes'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.ClassPerWave11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID wave;
     <span class="keywords">MODEL</span> emosup = wave / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.6: Add Time-Varying and Class Emotional Support'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 size23 time1*size23
                   girl time1*girl CMgirl50 time1*CMgirl50
                   emosup5 time1*emosup5 CMemosup5 time1*CMemosup5
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovEmosup13C InfoCrit=FitEmosup13C;
     <span class="keywords">CONTRAST</span> <span class="string">'Multivariate Test of Level-<span class="string">1</span> Within-Class Emotional Support Effects'</span> emosup5 <span class="number">1</span>, time1*emosup5 <span class="number">1</span> / <span class="keywords">CHISQ</span>;
     <span class="keywords">CONTRAST</span> <span class="string">'Multivariate Test of Level-<span class="string">3</span> Contextual Class Emotional Support Effects'</span> CMemosup5 <span class="number">1</span>, time1*CMemosup5 <span class="number">1</span> / <span class="keywords">CHISQ</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">7</span>, CovFewer=CovGirlC, CovMore=CovEmosup13C);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Remove Class Size, Add Random Level-<span class="string">1</span> Emotional Support across Classes'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   emosup5 time1*emosup5 CMemosup5 time1*CMemosup5
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 emosup5 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitEmosup13RC;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: New Baseline for Pseudo-R2 without Class Size Effects'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=FitGirlNewC;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Just Level-<span class="string">3</span> Emotional Support Effects'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovEmosup3C InfoCrit=FitEmosup3C;
     <span class="keywords">CONTRAST</span> <span class="string">'Multivariate Test of Level-<span class="string">3</span> Between-Class Emotional Support Effects'</span> CMemosup5 <span class="number">1</span>, time1*CMemosup5 <span class="number">1</span> / <span class="keywords">CHISQ</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Between-Class Emotional Support Effect at Wave <span class="string">1</span>'</span>     CMemosup5 <span class="number">1</span> CMemosup5*time1 <span class="number">0</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Between-Class Emotional Support Effect at Wave <span class="string">2</span>'</span>     CMemosup5 <span class="number">1</span> CMemosup5*time1 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Between-Class Emotional Support Effect at Wave <span class="string">3</span>'</span>     CMemosup5 <span class="number">1</span> CMemosup5*time1 <span class="number">2</span> /<span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">7</span>, CovFewer=FitGirlNewC, CovMore=CovEmosup3C);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.3: Saturated Means, Unstructured Level-<span class="string">3</span> and Level-<span class="string">2</span> Variances'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'for Student Victimization'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID wave;
     <span class="keywords">MODEL</span> victim = wave / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> wave /<span class="keywords"> G </span><span class="keywords">GCORR</span><span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords">REPEATED</span> wave /<span class="keywords"> R </span><span class="keywords">RCORR</span><span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitSatUNV;
     <span class="keywords">LS<span class="keywords">MEAN</span>S</span> wave / <span class="keywords">D<span class="keywords">IF</span>F</span><span class="keywords">=ALL</span><span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Piecewise Means, Level-<span class="string">3</span> and Level-<span class="string">2</span> Random Intercepts'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Three-Level Model Predicting Student Victimization'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> victim = time1 w3 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitPieceRI2RI3V;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitPieceRI2RI3V, FitMore=FitSatUNV);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Piecewise Means, Add Level-<span class="string">2</span> Random Time Slope'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Three-Level Model Predicting Student Victimization'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> victim = time1 w3 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitPieceRL2RI3V;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitPieceRI2RI3V, FitMore=FitPieceRL2RI3V);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Piecewise Means, Add Level-<span class="string">3</span> Random Time Slope'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Three-Level Model Predicting Student Victimization'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> victim = time1 w3 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitPieceRL2RL3V;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitPieceRL2RI3V, FitMore=FitPieceRL2RL3V);
     %FitTest(FitFewer=FitPieceRL2RL3V, FitMore=FitSatUNV);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Fixed Linear Time, Level-<span class="string">3</span> and Level-<span class="string">2</span> Random Intercepts'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Three-Level Model Predicting Student Victimization'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> victim = time1 / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add All <span class="string">3</span> Main Effects of Student Vicitimization Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Variable-Centered Level-<span class="string">1</span> and Level-<span class="string">2</span> Victim Predictors'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                   WSvictim WCvictim CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovVicVBC InfoCrit=FitVicVBC;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">1</span> Within-Student Victim Effect'</span>                 WSvictim <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">2</span> Within-Class   Victim Effect'</span>                 WCvictim <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">3</span> Between-Class  Victim Effect'</span>                 CMvictim3 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">2</span> Within-Class  Contextual Victim Effect'</span>       WSvictim -<span class="number">1</span> WCvictim <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">3</span> Between-Class Contextual Victim Effect'</span>       WCvictim -<span class="number">1</span> CMvictim3 <span class="number">1</span> /<span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">7</span>, CovFewer=CovEmosup3C, CovMore=CovVicVBC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add All <span class="string">3</span> Main Effects of Student Vicitimization Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Constant-Centered Level-<span class="string">1</span> and Level-<span class="string">2</span> Victim Predictors'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                   victim3 SMvictim3 CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovVicCBC;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">1</span> Within-Student Victim Effect'</span>                 victim3 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">2</span> Within-Class   Victim Effect'</span>                 victim3 <span class="number">1</span> SMvictim3 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">3</span> Between-Class  Victim Effect'</span>                 victim3 <span class="number">1</span> SMvictim3 <span class="number">1</span> CMvictim3 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">2</span> Within-Class  Contextual Victim Effect'</span>       SMvictim3 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">3</span> Between-Class Contextual Victim Effect'</span>       CMvictim3 <span class="number">1</span> /<span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">7</span>, CovFewer=CovEmosup3C, CovMore=CovVicCBC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Constant-Centered Student Vicitimization Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'For Table <span class="string">11.3</span>: Level-<span class="string">2</span> and Level-<span class="string">3</span> Effects, Omitting Level-<span class="string">1</span> Effect'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 SMvictim3 CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Constant-Centered Student Vicitimization Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'For Table <span class="string">11.3</span>: Level-<span class="string">1</span> and Level-<span class="string">3</span> Effects Only, Omitting Level-<span class="string">2</span> Effect'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 victim3 CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Constant-Centered Student Vicitimization Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'For Table <span class="string">11.3</span>: Level-<span class="string">1</span> and Level-<span class="string">2</span> Effects, Omitting Level-<span class="string">3</span> Effect'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 victim3 SMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Constant-Centered Student Vicitimization Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'For Table <span class="string">11.3</span>: Level-<span class="string">1</span> Effect Only, Omitting Level-<span class="string">2</span> and Level-<span class="string">3</span> Effects'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 victim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add All <span class="string">3</span> Victim*Time Interactions Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Variable-Centered Level-<span class="string">1</span> and Level-<span class="string">2</span> Victim Predictors'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                   WSvictim WCvictim CMvictim3
                   time1*WSvictim time1*WCvictim time1*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add All <span class="string">3</span> Victim*Time Interactions Predicting Student Closeness'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Constant-Centered Level-<span class="string">1</span> and Level-<span class="string">2</span> Victim Predictors'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                   victim3 SMvictim3 CMvictim3
                   time1*victim3 time1*SMvictim3 time1*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Random Within-Class Vicitimization Effect across Classes'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Variable-Centered Level-<span class="string">1</span> and Level-<span class="string">2</span> Victim Predictors'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                   WSvictim WCvictim CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WCvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitVicRWC3C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitVicVBC, FitMore=FitVicRWC3C);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Random Within-Student Vicitimization Effect across Students'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Variable-Centered Level-<span class="string">1</span> and Level-<span class="string">2</span> Victim Predictors'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                   WSvictim WCvictim CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovRandVic InfoCrit=FitVicRWS2C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitVicVBC, FitMore=FitVicRWS2C);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Random Within-Student Vicitimization Effect across Classes'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Using Variable-Centered Level-<span class="string">1</span> and Level-<span class="string">2</span> Victim Predictors'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5
                   WSvictim WCvictim CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WCvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> InfoCrit=FitVicRWS23C;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate LRT for nested models;</span>
     %FitTest(FitFewer=FitVicRWS2C, FitMore=FitVicRWS23C);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Quadratic Level-<span class="string">3</span> Effects of Gender'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMgirl50 time1*CMgirl50*CMgirl50
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Quadratic Level-<span class="string">3</span> Effects of Emotional Support'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMemosup5*CMemosup5 time1*CMemosup5*CMemosup5
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Quadratic Effect of Victimization at Each Level'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMvictim3*CMvictim3 WCvictim*WCvictim WSvictim*WSvictim
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Two-Way and Three-Way Interactions Among Level-<span class="string">3</span> Effects'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMgirl50*CMvictim3 CMemosup5*CMvictim3
                   time1*CMgirl50*CMemosup5 time1*CMgirl50*CMvictim3 time1*CMemosup5*CMvictim3
                   CMgirl50*CMemosup5*CMvictim3 time1*CMgirl50*CMemosup5*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Keep Gender*Emotional Support and Emotional Support*Victimization Level-<span class="string">3</span> Interactions'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovL3x;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">10</span>, CovFewer=CovRandVic, CovMore=CovL3x);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.8: Add Level-<span class="string">2</span> Interactions (and Contextual Level-<span class="string">3</span> Interactions)'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovL32x;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">10</span>, CovFewer=CovL3x, CovMore=CovL32x);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Time by Level-<span class="string">2</span> Interactions (and Contextual Level-<span class="string">3</span> Interactions)'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim
                   time1*WCvictim time1*girl*WCvictim time1*CMvictim3 time1*CMgirl50*WCvictim
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Level-<span class="string">3</span> by Student Gender Cross-Level Interactions'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim
                   girl*CMgirl50 girl*CMemosup5 girl*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Level-<span class="string">3</span> by Within-Class Victim Cross-Level Interactions'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim
                   WCvictim*CMemosup5 WCvictim*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Level-<span class="string">3</span> by Within-Student Victim Cross-Level Interactions'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim
                   WSvictim*CMgirl50 WSvictim*CMemosup5 WSvictim*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.9: Add Level-<span class="string">2</span> and Level-<span class="string">3</span> Victim by Within-Student Victim Cross-Level Interactions'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim
                   WSvictim*WCvictim WSvictim*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite <span class="keywords"><span class="keywords">OUTP</span>M</span>=FinalC;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
     <span class="keywords">ODS</span> <span class="keywords"><span class="keywords">OUTP</span>UT</span> CovParms=CovL32xVicx;
     <span class="keywords">ESTIMATE</span> <span class="string">'Contextual Gender Effect at Wave <span class="string">1</span>'</span>                   CMgirl50 <span class="number">1</span> CMgirl50*time1 <span class="number">0</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Contextual Gender Effect at Wave <span class="string">2</span>'</span>                   CMgirl50 <span class="number">1</span> CMgirl50*time1 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Contextual Gender Effect at Wave <span class="string">3</span>'</span>                   CMgirl50 <span class="number">1</span> CMgirl50*time1 <span class="number">2</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Between-Class Emotional Support Effect at Wave <span class="string">1</span>'</span>     CMemosup5 <span class="number">1</span> CMemosup5*time1 <span class="number">0</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Between-Class Emotional Support Effect at Wave <span class="string">2</span>'</span>     CMemosup5 <span class="number">1</span> CMemosup5*time1 <span class="number">1</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Between-Class Emotional Support Effect at Wave <span class="string">3</span>'</span>     CMemosup5 <span class="number">1</span> CMemosup5*time1 <span class="number">2</span> /<span class="keywords"> CL</span>;
     <span class="keywords">ESTIMATE</span> <span class="string">'Level-<span class="string">2</span> Victim Effect in Girls'</span>                       WCvictim <span class="number">1</span> WCvictim*girl <span class="number">1</span> /<span class="keywords"> CL</span>;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
<span class="comment">     * Call macro to calculate pseudo R2;</span>
     %PseudoR2(NCov=<span class="number">10</span>, CovFewer=CovL32x, CovMore=CovL32xVicx);
<span class="comment">     * Call macro to calculate Total R2 for overall model;</span>
     %TotalR2(DV=close, PredFewer=PredEmpty, PredMore=FinalC);
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Ch <span class="string">11</span>a: Add Level-<span class="string">2</span> and Level-<span class="string">3</span> Gender by Within-Student Victim Cross-Level Interactions'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=REML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim WSvictim*WCvictim WSvictim*CMvictim3
                   WSvictim*girl WSvictim*CMgirl50
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="keywords"><span class="keywords">TITLE</span>1</span> <span class="string">'Eq <span class="string">11</span>a.9: Add Level-<span class="string">2</span> and Level-<span class="string">3</span> Victim by Within-Student Victim Cross-Level Interactions'</span>;
<span class="keywords"><span class="keywords">TITLE</span>2</span> <span class="string">'Predicting Student Closeness using ML instead of REML'</span>;
<span class="command">PROC MIXED</span> <span class="command">DATA</span>=work.Chapter11a <span class="keywords">COVTEST</span> NOCLPRINT <span class="keywords">NAMELEN</span>=<span class="number">100</span><span class="keywords"> IC</span> <span class="keywords">METHOD</span>=ML;
    <span class="keywords"><span class="keywords"> CL</span>ASS</span> ClassID StudentID;
     <span class="keywords">MODEL</span> close = time1 girl time1*girl CMgirl50 time1*CMgirl50
                   CMemosup5 time1*CMemosup5 WSvictim WCvictim CMvictim3
                   CMgirl50*CMemosup5 CMemosup5*CMvictim3
                   girl*WCvictim CMgirl50*WCvictim
                   WSvictim*WCvictim WSvictim*CMvictim3
                    / <span class="keywords">SOLUTION</span><span class="keywords"> CL</span> <span class="keywords">CHISQ</span> <span class="keywords">DDFM</span>=Satterthwaite;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID;
     <span class="keywords"><span class="keywords">RAN<span class="keywords">DO</span>M</span></span> INTERCEPT time1 WSvictim /<span class="keywords"> TYPE</span>=UN <span class="keywords">SUBJECT</span>=ClassID*StudentID;
<span class="command">RUN</span>; <span class="keywords"><span class="keywords">TITLE</span>1</span>; <span class="keywords"><span class="keywords">TITLE</span>2</span>;
 
<span class="comment">****** END CHAPTER 11a MODELS ******;</span>

<span class="comment">* Close output directory;</span>
<span class="keywords">ODS</span> <span class="keywords">HTML </span><span class="keywords">CLOSE</span>;
</body></html>
</pre></body></html>