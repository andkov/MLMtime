{
    "contents" : "# remove all elements for a clean start\nrm(list=ls(all=TRUE))\n# Supplementary Material for Longitudinal Analysis: Modeling Within-Person Fluctuation and Change \n# Chapter 2: MPLUS Syntax and Output by Model\n\n## @knitr LoadPackages\nrequire(sas7bdat)\nlibrary(nlme)\nlibrary(dplyr)\nlibrary(reshape2)\nlibrary(ggplot2)\n\n\n## @knitr LoadData\npathDir  <- getwd()\npathChapter  <- file.path(pathDir,\"Chapters/03/SAS_Chapter3a/SAS_Chapter3a.sas7bdat\")\ndsL3   <- read.sas7bdat(pathChapter, debug=TRUE) \nds <- data.frame(dsL3)\nnames(ds)\nstr(data.frame(ds))\n# basic tables\nhead(ds)\n\nsummary(ds)\n\ntable(ds$group)\n\n# stack data \ndsLong <- reshape2::melt(ds,id.vars=c(\"PersonID\",\"group\"))\n# sort for visual inspection\ndsLong <- dsLong[order(dsLong$PersonID, dsLong$PersonID),]\nhead(dsLong,12)\n# tweak the datatset\ndsLong$variable <- gsub(pattern=\"outcome\", replacement='', x=dsLong$variable)\nhead(dsLong,12)\ndsLong <- dplyr::select(dsLong, id=PersonID, group,time=variable, outcome=value)\nds <- dsLong\n\n\nds$group <- ordered(ds$group,\n                               levels = c(1,2),\n                               labels = c(\"Control\",\"Treatment\"))\nds$time <- ordered(ds$time,\n                    levels = c(1,2),\n                    labels = c(\"Pre-Test\",\"Post-Test\"))\n\nstr(ds)\n\n\n\nhead(dsLong)\nds <- dsLong\nhead(ds)\n# Load graph themes\nsource(\"Scripts/Graphs/graphThemes.R\")\n# graph\np <- ggplot2::ggplot(ds,aes(x=time,y=outcome))\np <- p + geom_line(aes(group=id, color=factor(group)), alpha=1,\n                   position=position_jitter(w=0.0, h=0.0))\np <- p + theme1\np <- p + scale_x_discrete(limits=c(1,2), labels=c(\"Pre-Test\",\"Post-Test\"))\np <- p + scale_y_continuous(limits=c(30,70), \n                            breaks=seq(30,70, by=5))\np <- p + facet_grid(.~group)\n# p <- p + labs(list(\n#   title=\"How often did you attend worship last year?\",\n#   x=\"Year of observation\", y=\"Church attendance\"))\np\n\n\n\n\n\n## @knitr EmptyMeansModel\nm3.1 <- nlme::gls(outcome ~ 1, data=ds, method=\"ML\")\nsummary(m3.1)\nds$m3.1 <- predict(m3.1)\n\n\nmodel <- m3.1\nlogLik<- summary(model)$logLik\ndeviance<- -2*logLik\nAIC<- AIC(model)\nBIC<- BIC(model)\ndf.resid<- NA\nN<- summary(model)$dims$N\np<- summary(model)$dims$p\nids<- length(unique(ds$PersonID))\ndf.resid<- N-p\nmInfo<- data.frame(\"logLik\" = logLik, \n                   \"deviance\"= deviance, \n                   \"AIC\" = AIC, \"BIC\" = BIC,\n                   \"df.resid\" = df.resid, \"N\" = N, \n                   \"p\" = p, \"ids\" = ids)\nt<- t(mInfo)\nrownames(t)<-colnames(mInfo)\ndsmInfo<- data.frame(new=t)\ncolnames(dsmInfo) <- c(\"m3.1\")\n# dsmInfo$Coefficient <- rownames(dsmInfo)\nmo3.1 <- dsmInfo\nmo3.1$Coefficient <- rownames(mo3.1)\nsummary(m3.1)\nprint(mo3.1)\n\n\n\n## @knitr EmptyMeansModel\nm3.2 <- lme4::lmer(outcome ~ 1 + (1|id), data=ds, REML=FALSE)\nsummary(m3.2)\nds$m3.2 <- predict(m3.2)\n\nmodel <- m3.2\nmInfo<-summary(model)$AICtab\nmInfo[\"N\"]<- model@devcomp$dims[\"N\"] # number of datapoints, verify\nmInfo[\"p\"]<- model@devcomp$dims[\"p\"] # number of estimated parameters, verify\nmInfo[\"ids\"]<- (summary(model))$ngrps # number of units on level-2, here: individuals\n# mInfo<- c(mInfo, \"modelName\"=modelName)\ndsmInfo<-data.frame(mInfo)\ndsmInfo<- plyr::rename(dsmInfo,replace= c(\"mInfo\"=\"m3.2\"))\ndsmInfo$Coefficient <- rownames(dsmInfo)\nmo3.2 <- dsmInfo # model information \n\nprint(mo3.2)\nprint(mo3.1) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1421087715014.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "253230300",
    "id" : "30854302",
    "lastKnownWriteTime" : 1421766066,
    "path" : "~/GitHub/psy564/Chapters/02/R_Chapter2/hoffman-ch3.R",
    "project_path" : "Chapters/02/R_Chapter2/hoffman-ch3.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}