{
    "contents" : "# remove all elements for a clean start\nrm(list=ls(all=TRUE))\ncat(\"\\014\")\n\n\n## @knitr InstallPackage\n# source(\"./Scripts/Utility/InstallPackages.R\")\n\n\n\n## @knitr LoadPackages\nrequire(sas7bdat) # for inputting data \nlibrary(dplyr) # for general data manipulation\nlibrary(reshape2) # for data : wide <-> long\nlibrary(psych) # data summary + etc\nlibrary(ggplot2) # graphing\nlibrary(nlme) # estimate fixed models | esp. gls()\nlibrary(lme4) # estimate mixed models | esp. lmer()\nlibrary(arm)  # process model objects\n\n\n## @knitr LoadData\nds0 <- readRDS(\"~/GitHub/psy564/Data/Raw/ELSA/ds0_ELSA.rds\")\ndim(ds0)\nlength(unique(ds0$PID))\nhead(ds0)\n\ndsL <- ds0\n \n## @knitr DataFilter\ndsM <- dsL\n\ntable(dsM$irecall,dsM$wave, useNA=\"ifany\")\n# There are no valid respondes to the focal outcome, so we remove wave 5\n# Wave 0 doesn't not contain observations of interest, so remove wave 0\ndsM <- dplyr::filter(dsM, wave %in% c(1:4))  \ntable(dsM$irecall,dsM$wave, useNA=\"ifany\")\n# The missing values will complecate some of the modeling so remove for now\n\n\n## @knitr DataFilter2\n# Selecting individuals into the working dataset\nlength(unique(dsM$id))\ntable(dsM$wave)\ndsM <- dplyr::filter(dsM, (ave(!is.na(irecall), id, FUN = all))) # only complete trajectoies\nlength(unique(dsM$id))\ntable(dsM$wave)\ndsM <- dsM[dsM$id %in% unique((dsM[dsM$wave==4,c(\"id\",\"wave\")])$id ),] # only who reached 4th wave\nlength(unique(dsM$id))\ntable(dsM$wave)\n\n\nsaveRDS(object=dsM, file=\"~/GitHub/psy564/Data/Derived/ELSA/dsM_ELSA.rds\", compress=\"xz\") \n\n## @knitr LoadGraphThemes\npaletteColor4conditions <- c(\"Hypertension\"=\"red\",\n                             \"Diabetes\"=\"blue\",\n                             \"Both\"=\"purple\",\n                             \"None\"=\"grey10\")\n\n\nbaseSize <- 12 # set as the point of further reference\ntheme1 <- ggplot2::theme_bw(base_size=baseSize) +\n  ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = baseSize+1)) +\n  ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\", size=baseSize-2)) +\n  ggplot2::theme(axis.title=ggplot2::element_text(colour=\"gray40\")) +\n  ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\")) +\n  ggplot2::theme(axis.ticks.length = grid::unit(0, \"cm\")) +\n  ggplot2::theme(text = element_text(size =baseSize+7)) \n\n\n## @knitr CrossSectionDist\n# Cross-sectional view: irecall\np <- ggplot2::ggplot(dsM, aes(y=irecall,x=factor(year), fill=condition))\np <- p + geom_violin( adjust=1, alpha=.4 )\np <- p + scale_y_continuous(limits=c(0,10), breaks=seq(0,10,by=1))\np <- p + scale_fill_manual(values=paletteColor4conditions)\np <- p + geom_boxplot(width=1, fill=NA, color=\"black\", alpha=.5, outlier.colour=\"red\") \np <- p + stat_summary(fun.y=mean, geom=\"point\", fill=\"white\", shape=21, size=4)\np <- p + facet_grid(dbts ~ hptn)\np <- p + theme1\np\n\n## @knitr CrossSectionCount\n# Cross-sectional view: frequence of irecall\np <- ggplot2::ggplot(dsM, aes(x=factor(year)))\np <- p + scale_y_continuous(breaks=seq(0,6000,by=1000))\np <- p + geom_bar(aes(fill=condition), alpha=.4)\np <- p + facet_grid(dbts ~ hptn)\np <- p + scale_fill_manual(values=paletteColor4conditions)\np <- p + guides(fill = guide_legend(reverse=F, title=\"Diagnosis at A\")) \np <- p + theme1\np\n\n\n## @knitr EasyData\nds <- dplyr::filter(dsM, id %in% sample(unique(id),100)) %>% # select only N ids\n  dplyr::select(id, dob, female, hptn, dbts, condition, year, time, Age, irecall,animal,prospect, drecall)\nhead(ds)\n\n\n\n\n",
    "created" : 1425590400066.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1317891802",
    "id" : "EF7321DA",
    "lastKnownWriteTime" : 1425589640,
    "path" : "~/GitHub/psy564/Chapters/05/R_Chapter5/dsELSA.R",
    "project_path" : "Chapters/05/R_Chapter5/dsELSA.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}